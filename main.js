// MOBILE TAKEOVER SHIT ---------------------------------------------

var ctnButton = document.getElementById("mobile-end-button");
ctnButton.onclick = function() {
	document.getElementById("mobile").style.display = "none";
	document.getElementById("page").style.display = "block";
};

var clipmakerRateElement;
var clipmakerRate2Element;
var availableMatterDisplayElement;
var acquiredMatterDisplayElement;
var mapsElement;
var nanoWireElement;
var wppsElement;
var probeDesignDivElement;
var increaseProbeTrustDivElement;
var increaseMaxTrustDivElement;
var spaceDivElement;
var battleCanvasDivElement;
var honorDivElement;
var wireProductionDivElement;
var wireTransDivElement;
var swarmGiftDivElement;
var swarmEngineElement;
var swarmSliderDivElement;
var factoryDivSpaceElement;
var clipsPerSecDivElement;
var tothDivElement;
var strategyEngineElement;
var tournamentManagementElement;
var btnQcomputeElement;
var qComputingElement;
var transWireElement;
var processorDisplayElement;
var compDivElement;
var projectsDivElement;
var creationDivElement;
var stratPickerElement;
var investUpgradeCostElement;
var yomiDisplayElement;
var investmentBankrollElement;
var fundsElement;
var secValueElement;
var portValueElement;
var investStratElement;
var btnRunTournamentElement;
var vertStratElement;
var horizStratElement;
var vLabelaElement;
var vLabelbElement;
var hLabelaElement;
var hLabelbElement;
var aaPayoffHElement;
var aaPayoffVElement;
var abPayoffHElement;
var abPayoffVElement;
var baPayoffHElement;
var baPayoffVElement;
var bbPayoffHElement;
var bbPayoffVElement;
var autoTourneyStatusElement;
var tournamentTableElement;
var tournamentResultsTableElement;
var tourneyDisplayElement;
var payoffCellAAElement;
var payoffCellABElement;
var payoffCellBAElement;
var payoffCellBBElement;
var clipmakerLevel2Element;
var clipperCostElement;
var megaClipperLevelElement;
var megaClipperCostElement;
var nextFactoryUpgradeElement;
var nextDroneUpgradeElement;
var factoryLevelDisplayElement;
var factoryCostDisplayElement;
var harvesterLevelDisplayElement;
var harvesterCostDisplayElement;
var wireDroneLevelDisplayElement;
var wireDroneCostDisplayElement;
var btnMakeHarvesterElement;
var btnHarvesterx10Element;
var btnHarvesterx100Element;
var btnHarvesterx1000Element;
var btnMakeWireDroneElement;
var btnWireDronex10Element;
var btnWireDronex100Element;
var btnWireDronex1000Element;
var sliderElement;
var btnSynchSwarmElement;
var btnEntertainSwarmElement;
var swarmSizeElement;
var swarmGiftsElement;
var swarmStatusElement;
var giftCountdownElement;
var giftTimerElement;
var feedButtonDivElement;
var teachButtonDivElement;
var swarmEntertainCostElement;
var entertainButtonDivElement;
var cladButtonDivElement;
var synchButtonDivElement;
var swarmStatusDivElement;
var swarmEngineElement;
var farmLevelElement;
var farmCostElement;
var batteryLevelElement;
var batteryCostElement;
var powerProductionRateElement;
var powerConsumptionRateElement;
var storedPowerElement;
var facPowConRateElement;
var dronePowConRateElement;
var maxStorageElement;
var performanceElement;
var btnMakeFarmElement;
var btnMakeBatteryElement;
var btnFarmRebootElement;
var btnBatteryRebootElement;
var btnFarmx10Element;
var btnFarmx100Element;
var btnBatteryx10Element;
var btnBatteryx100Element;
var powerDivElement;
var adCostElement;
var marketingLvlElement;
var demandElement;
var marginElement;
var inchSpanElement;
var demandElement;
var operationsElement;
var trustElement;
var nextTrustElement;
var creativityElement;
var factoryLevelDisplaySpaceElement;
var harvesterLevelSpaceElement;
var wireDroneLevelSpaceElement;
var maxOpsElement;
var avgSalesElement;
var avgRevElement;
var probeTrustCostDisplayElement;
var mdpsElement;
var colonizedDisplayElement;
var probesLostHazardsDisplayElement;
var probesTotalDisplayElement;
var probesLostDriftDisplayElement;
var probesTotalDisplayElement;
var drifterCountElement;
var mapsElement;
var swarmGiftDivElement;
var swarmEngineElement;
var clipsPerSecDivElement;
var tothDivElement;
var prestigeUcounterElement;
var prestigeScounterElement;
var prestigeXcounterElement;
var newTourneyCostElement;
var maxTrustDisplayElement;
var victoryDivElement;
var probeTrustCostDisplayElement;
var tournamentResultsTableElement;
var farmCostElement;
var batteryCostElement;
var farmLevelElement;
var batteryLevelElement;
var wireDroneCostDisplayElement;
var wireDroneLevelDisplayElement;
var harvesterCostDisplayElement;
var harvesterLevelDisplayElement;
var megaClipperCostElement;
var megaClipperLevelElement;
var investmentBankrollElement;
var secValueElement;
var portValueElement;
var investUpgradeCostElement;
var driftersKilledElement;
var availableMatterDisplayElement;
var honorDisplayElement;
var clipmakerLevel2Element;
var clipperCostElement;
var acquiredMatterDisplayElement;
var nanoWireElement;
var probesBornDisplayElement;
var probesTotalDisplayElement;
var probesLaunchedDisplayElement;
var probeCostDisplayElement;
var probeCombatDisplayElement;
var probeWireDisplayElement;
var probeHarvDisplayElement;
var probeFacDisplayElement;
var probeRepDisplayElement;
var probeHazDisplayElement;
var probeNavDisplayElement;
var probeSpeedDisplayElement;
var probeTrustDisplayElement;
var memoryElement;
var processorsElement;
var marginElement;
var marketingLvlElement;
var adCostElement;
var factoryCostDisplayElement;
var factoryLevelDisplayElement;
var yomiDisplayElement;
var projectListTopElement;
var investmentLevelElement;

var wireCostElement;
var wireElement;

var qCompDisplayElement;

var hypnoDroneTextElement;
var hypnoDroneEventDivElement;

var readoutElement1;
var readoutElement2;
var readoutElement3;
var readoutElement4;
var readoutElement5;

var mpdsDivElement;

var factoryRebootToolTipElement;
var havesterRebootToolTipElement;
var wireDroneRebootToolTipElement;
var farmRebootToolTipElement;
var batteryRebootToolTipElement;

var swarmSliderDivElement;
var clipCountCrunchedElement;
var autoTourneyStatusDivElement;
var autoTourneyControlElement;

var wireBuyerDivElement;
var tournamentResultsTableElement;
var tournamentStuffElement;

var increaseMaxTrustDivElement;
var honorDivElement;
var drifterDivElement;
var battleCanvasDivElement;
var combatButtonDivElement;
var factoryUpgradeDisplayElement;
var droneUpgradeDisplayElement;
var btnIncreaseMaxTrustElement;
var btnMakerProbeElement;
var hazardBodyCountElement;
var probesLostHazardsDisplayElement;
var driftBodyCountElement;
var combatBodyCountElement;
var prestigeDivElement;
var btnMakePaperclipElement;
var btnBuyWireElement;
var btnMakeClipperElement;
var btnExpandMarketingElement;
var btnLowerPriceElement;
var btnAddProcElement;
var btnAddMemElement;
var btnNewTournamentElement;
var btnImproveInvestmentsElement;
var investmentEngineElement;
var investmentEngineUpgradeElement;
var strategyEngineElement;
var tournamentManagementElement;
var megaClipperDivElement;
var btnMakeMegaClipperElement;
var autoClipperDivElement;
var revPerSecDivElement;
var compDivElement;
var creativityDivElement;
var projectsDivElement;
var businessDivElement;
var manufacturingDivElement;
var trustDivElement;
var creationDivElement;
var factoryDivElement;
var wireProductionDivElement;
var wireTransDivElement;
var harvesterDivElement;
var wireDroneDivElement;
var tothDivElement;
var spaceDivElement;
var factoryDivSpaceElement;
var droneDivSpaceElement;
var probeDesignDivElement;
var increaseProbeTrustDivElement;
var qComputingElement;
var btnMakeFactoryElement;
var btnHarvesterRebootElement;
var btnWireDroneRebootElement;
var btnFactoryRebootElement;

var probeTrustUsedDisplayElement;
var btnIncreaseProbeTrustElement;
var btnRaiseProbeSpeedElement;
var btnLowerProbeSpeedElement;
var btnRaiseProbeNavElement;
var btnLowerProbeNavElement;
var btnRaiseProbeRepElement;
var btnLowerProbeRepElement;
var btnRaiseProbeHazElement;
var btnLowerProbeHazElement;
var btnRaiseProbeFacElement;
var btnLowerProbeFacElement;
var btnRaiseProbeHarvElement;
var btnLowerProbeHarvElement;
var btnRaiseProbeWireElement;
var btnLowerProbeWireElement;
var btnRaiseProbeCombatElement;
var btnLowerProbeCombatElement;

var coverElement;

var unusedClipsDisplayElement;
var transWireElement;
var nanoWireElement;
var clipsElement;
var unsoldClipsElement;

var stockSymbolElements = [];
var stockAmountElements = [];
var stockPriceElements = [];
var stockTotalElements = [];
var stockProfitElements = [];

var tourneyResultsElements = [];

// Cache
cacheDOMElements();

function buttonUpdate() {

	if (swarmFlag == 0) {
		swarmEngineElement.style.display = "none";
		swarmGiftDivElement.style.display = "none";
	} else {
		swarmEngineElement.style.display = "";
		swarmGiftDivElement.style.display = "";
	}

	if (project127.flag == 1 && spaceFlag == 0) {
		powerDivElement.style.display = "";
	} else {
		powerDivElement.style.display = "none";
	}

	if (spaceFlag == 0) {
		mpdsDivElement.style.display = "none";
	} else if (spaceFlag == 1) {
		mpdsDivElement.style.display = "";
	}

	factoryRebootToolTipElement.innerHTML = "+" + spellf(factoryBill)
			+ " clips";
	havesterRebootToolTipElement.innerHTML = "+" + spellf(harvesterBill)
			+ " clips";
	wireDroneRebootToolTipElement.innerHTML = "+" + spellf(wireDroneBill)
			+ " clips";
	farmRebootToolTipElement.innerHTML = "+" + spellf(farmBill) + " clips";
	batteryRebootToolTipElement.innerHTML = "+" + spellf(batteryBill)
			+ " clips";

	if (swarmFlag == 1) {
		swarmSliderDivElement.style.display = "";
	} else {
		swarmSliderDivElement.style.display = "none";
	}

	clipCountCrunchedElement.innerHTML = spellf(Math.round(clips));

	if (autoTourneyFlag == 1) {
		autoTourneyStatusDivElement.style.display = "";
		autoTourneyControlElement.style.display = "";
	} else {
		autoTourneyStatusDivElement.style.display = "none";
		autoTourneyControlElement.style.display = "none";
	}

	qCompDisplayElement.style.opacity = qFade;
	qFade = qFade - .001;

	if (wireBuyerFlag == 1) {
		wireBuyerDiv.style.display = "";
	} else {
		wireBuyerDiv.style.display = "none";
	}

	if (resultsFlag == 1 && autoTourneyFlag == 1 && autoTourneyStatus == 1
			&& tournamentResultsTableElement.style.display == "") {
		resultsTimer++;

		if (resultsTimer >= 300 && operations >= tourneyCost) {
			newTourney();
			runTourney();
			resultsTimer = 0;
		}
	}

	tournamentStuffElement.onmouseover = function() {
		revealGrid()
	}; // m@: does this need to happen every button update? idts, but TODO:
	// look this up
	tournamentStuffElement.onmouseout = function() {
		revealResults()
	};

	if (project121.flag == 0) {
		increaseMaxTrustDivElement.style.display = "none";
		honorDivElement.style.display = "none";
	} else {
		increaseMaxTrustDivElement.style.display = "";
		honorDivElement.style.display = "";
	}

	if (battleFlag == 0) {
		drifterDivElement.style.display = "none";
	} else {
		drifterDivElement.style.display = "";
	}

	if (battleFlag == 0) {
		battleCanvasDivElement.style.display = "none";
	} else {
		battleCanvasDivElement.style.display = "";
	}

	if (project131.flag == 0) {
		combatButtonDivElement.style.display = "none";
	} else {
		combatButtonDivElement.style.display = "";
	}

	if (maxFactoryLevel >= 50 || project45.flag == 0) {
		factoryUpgradeDisplayElement.style.display = "none";
	} else {
		factoryUpgradeDisplayElement.style.display = "";
	}

	if (maxDroneLevel >= 50000) {
		droneUpgradeDisplayElement.style.display = "none";
	}

	if (honor < maxTrustCost) {
		btnIncreaseMaxTrustElement.disabled = true;
	} else {
		btnIncreaseMaxTrustElement.disabled = false;
	}

	if (unusedClips < probeCost) {
		btnMakerProbeElement.disabled = true;
	} else {
		btnMakerProbeElement.disabled = false;
	}

	if (probesLostHaz < 1) {
		hazardBodyCountElement.style.display = "none";
	} else {
		hazardBodyCountElement.style.display = "";

		probesLostHazardsDisplayElement.innerHTML = spellf(probesLostHaz);

	}

	if (probesLostDrift < 1) {
		driftBodyCountElement.style.display = "none";
	} else {
		driftBodyCountElement.style.display = "";
	}

	if (probesLostCombat < 1) {
		combatBodyCountElement.style.display = "none";
	} else {
		combatBodyCountElement.style.display = "";
	}

	// if (prestigeU<1 && prestigeS<1 && prestigeX<1)
	// {prestigeDivElement.style.display = "none";
	// } else {
	// prestigeDivElement.style.display = "";
	// }

	if (wire < 1) {
		btnMakePaperclipElement.disabled = true;
	} else {
		btnMakePaperclipElement.disabled = false;
	}
	if (funds < wireCost) {
		btnBuyWireElement.disabled = true;
	} else {
		btnBuyWireElement.disabled = false;
	}
	if (funds < clipperCost) {
		btnMakeClipperElement.disabled = true;
	} else {
		btnMakeClipperElement.disabled = false;
	}
	if (funds < adCost) {
		btnExpandMarketingElement.disabled = true;
	} else {
		btnExpandMarketingElement.disabled = false;
	}
	if (margin <= .01) {
		btnLowerPriceElement.disabled = true;
	} else {
		btnLowerPriceElement.disabled = false;
	}

	if (trust <= processors + memory && swarmGifts <= 0) {
		btnAddProcElement.disabled = true;
		btnAddMemElement.disabled = true;
	} else {
		btnAddProcElement.disabled = false;
		btnAddMemElement.disabled = false;
	}
	if (operations >= tourneyCost && tourneyInProg == 0) {
		btnNewTournamentElement.disabled = false;
	} else {
		btnNewTournamentElement.disabled = true;
	}
	if (yomi < investUpgradeCost) {
		btnImproveInvestmentsElement.disabled = true;
	} else {
		btnImproveInvestmentsElement.disabled = false;
	}
	if (investmentEngineFlag == 0) {

		investmentEngineElement.style.display = "none";
		investmentEngineUpgradeElement.style.display = "none";
	} else {

		investmentEngineElement.style.display = "";
		investmentEngineUpgradeElement.style.display = "";
	}

	if (strategyEngineFlag == 0) {

		strategyEngineElement.style.display = "none";
		tournamentManagementElement.style.display = "none";
	} else {

		strategyEngineElement.style.display = "";
		tournamentManagementElement.style.display = "";
	}

	if (megaClipperFlag == 0) {

		megaClipperDivElement.style.display = "none";
	} else {
		megaClipperDivElement.style.display = "";
	}

	if (funds < megaClipperCost) {
		btnMakeMegaClipperElement.disabled = true;
	} else {
		btnMakeMegaClipperElement.disabled = false;
	}

	if (autoClipperFlag === 0) {

		autoClipperDivElement.style.display = "none";
	} else {
		autoClipperDivElement.style.display = "";
	}

	if (funds >= 5) {
		autoClipperFlag = 1;
	}

	if (revPerSecFlag === 0) {

		revPerSecDivElement.style.display = "none";
	} else {
		revPerSecDivElement.style.display = "";
	}

	if (compFlag === 0) {

		compDivElement.style.display = "none";
	} else {
		compDivElement.style.display = "";
	}

	if (creativityOn === 0) {
		creativityDivElement.style.display = "none";
	} else {
		creativityDivElement.style.display = "";
	}

	if (projectsFlag === 0) {

		projectsDivElement.style.display = "none";
	} else {
		projectsDivElement.style.display = "";
	}

	if (humanFlag === 0) {

		businessDivElement.style.display = "none";
		manufacturingDivElement.style.display = "none";
		trustDivElement.style.display = "none";
		investmentEngineFlag = 0;
		wireBuyerFlag = 0;
		creationDivElement.style.display = "";
	} else {
		businessDivElement.style.display = "";
		manufacturingDivElement.style.display = "";
		trustDivElement.style.display = "";
		creationDivElement.style.display = "none";
	}

	if (factoryFlag === 0) {

		factoryDivElement.style.display = "none";
	} else {
		factoryDivElement.style.display = "";
	}

	if (wireProductionFlag === 0) {

		wireProductionDivElement.style.display = "none";
	} else {
		wireProductionDivElement.style.display = "";
		wireTransDivElement.style.display = "none";
	}

	if (harvesterFlag === 0) {

		harvesterDivElement.style.display = "none";
	} else {
		harvesterDivElement.style.display = "";
	}

	if (wireDroneFlag === 0) {

		wireDroneDivElement.style.display = "none";
	} else {
		wireDroneDivElement.style.display = "";
	}

	if (tothFlag === 0) {

		tothDivElement.style.display = "none";
	} else {
		tothDivElement.style.display = "";
	}

	if (spaceFlag === 0) {
		spaceDivElement.style.display = "none";
		factoryDivSpaceElement.style.display = "none";
		droneDivSpaceElement.style.display = "none";
		probeDesignDivElement.style.display = "none";
		increaseProbeTrustDivElement.style.display = "none";
	} else {
		spaceDivElement.style.display = "";
		factoryDivSpaceElement.style.display = "";
		droneDivSpaceElement.style.display = "";
		probeDesignDivElement.style.display = "";
		increaseProbeTrustDivElement.style.display = "";
		factoryDivElement.style.display = "none";
		harvesterDivElement.style.display = "none";
		wireDroneDivElement.style.display = "none";
	}

	if (qFlag === 0) {
		qComputingElement.style.display = "none";
	} else {
		qComputingElement.style.display = "";
	}

	if (unusedClips < factoryCost) {
		btnMakeFactoryElement.disabled = true;
	} else {
		btnMakeFactoryElement.disabled = false;
	}

	if (harvesterLevel === 0) {
		btnHarvesterRebootElement.disabled = true;
	} else {
		btnHarvesterRebootElement.disabled = false;
	}

	if (wireDroneLevel === 0) {
		btnWireDroneRebootElement.disabled = true;
	} else {
		btnWireDroneRebootElement.disabled = false;
	}

	if (factoryLevel === 0) {
		btnFactoryRebootElement.disabled = true;
	} else {
		btnFactoryRebootElement.disabled = false;
	}

	// PROBE DESIGN

	probeUsedTrust = (probeSpeed + probeNav + probeRep + probeHaz + probeFac
			+ probeHarv + probeWire + probeCombat);

	probeTrustUsedDisplayElement.innerHTML = probeUsedTrust;

	if (yomi < probeTrustCost || probeTrust >= maxTrust) {
		btnIncreaseProbeTrustElement.disabled = true;
	} else {
		btnIncreaseProbeTrustElement.disabled = false;
	}

	if (probeTrust - probeUsedTrust < 1) {
		btnRaiseProbeSpeedElement.disabled = true;
	} else {
		btnRaiseProbeSpeedElement.disabled = false;
	}

	if (probeSpeed < 1) {
		btnLowerProbeSpeedElement.disabled = true;
	} else {
		btnLowerProbeSpeedElement.disabled = false;
	}

	if (probeTrust - probeUsedTrust < 1) {
		btnRaiseProbeNavElement.disabled = true;
	} else {
		btnRaiseProbeNavElement.disabled = false;
	}

	if (probeNav < 1) {
		btnLowerProbeNavElement.disabled = true;
	} else {
		btnLowerProbeNavElement.disabled = false;
	}

	if (probeTrust - probeUsedTrust < 1) {
		btnRaiseProbeRepElement.disabled = true;
	} else {
		btnRaiseProbeRepElement.disabled = false;
	}

	if (probeRep < 1) {
		btnLowerProbeRepElement.disabled = true;
	} else {
		btnLowerProbeRepElement.disabled = false;
	}

	if (probeTrust - probeUsedTrust < 1) {
		btnRaiseProbeHazElement.disabled = true;
	} else {
		btnRaiseProbeHazElement.disabled = false;
	}

	if (probeHaz < 1) {
		btnLowerProbeHaz.disabled = true;
	} else {
		btnLowerProbeHaz.disabled = false;
	}

	if (probeTrust - probeUsedTrust < 1) {
		btnRaiseProbeFacElement.disabled = true;
	} else {
		btnRaiseProbeFacElement.disabled = false;
	}

	if (probeFac < 1) {
		btnLowerProbeFacElement.disabled = true;
	} else {
		btnLowerProbeFacElement.disabled = false;
	}

	if (probeTrust - probeUsedTrust < 1) {
		btnRaiseProbeHarvElement.disabled = true;
	} else {
		btnRaiseProbeHarvElement.disabled = false;
	}

	if (probeHarv < 1) {
		btnLowerProbeHarvElement.disabled = true;
	} else {
		btnLowerProbeHarvElement.disabled = false;
	}

	if (probeTrust - probeUsedTrust < 1) {
		btnRaiseProbeWireElement.disabled = true;
	} else {
		btnRaiseProbeWireElement.disabled = false;
	}

	if (probeWire < 1) {
		btnLowerProbeWireElement.disabled = true;
	} else {
		btnLowerProbeWireElement.disabled = false;
	}

	if (probeTrust - probeUsedTrust < 1) {
		btnRaiseProbeCombatElement.disabled = true;
	} else {
		btnRaiseProbeCombatElement.disabled = false;
	}

	if (probeCombat < 1) {
		btnLowerProbeCombatElement.disabled = true;
	} else {
		btnLowerProbeCombatElement.disabled = false;
	}

	coverElement.style.display = "none";
}

// HYPNODRONE EVENT
// ----------------------------------------------------------------
hypnoDroneEventDivElement.style.display = "none";

btnRunTournamentElement.disabled = true;

window.setInterval(function() {

	pick = stratPickerElement.value;

}, 100);

// --------------------------------------------------------------------------------

// CHECK FOR SAVES
if (localStorage.getItem("saveGame") != null) {
	load();
}
if (localStorage.getItem("savePrestige") != null) {
	loadPrestige();
	refresh();
}

// Check for Debug
checkDbg(location.search);

// Set Prestige Values
setPrestigeValues();

// MAIN LOOP
window.setInterval(function() {

					ticks = ticks + 1;
					milestoneCheck();
					buttonUpdate();

					if (compFlag == 1) {
						calculateOperations();
					}

					if (humanFlag == 1) {
						calculateTrust();
					}

					if (qFlag == 1) {
						quantumCompute();
					}

					updateStats();
					manageProjects();
					milestoneCheck();

					// Clip Rate Tracker

					clipRateTracker++;

					if (clipRateTracker < 100) {
						var cr = clips - prevClips;
						clipRateTemp = clipRateTemp + cr;
						prevClips = clips;

					} else {
						clipRateTracker = 0;
						clipRate = clipRateTemp;
						clipRateTemp = 0;
					}

					// Stock Report

					if (investmentEngineFlag == 1) {
						stockReportCounter++;
						if (stockReportCounter >= 10000) {
							var r = formatWithCommas(ledger + portTotal);
							displayMessage("Lifetime investment revenue report: $"
									+ r);
							stockReportCounter = 0;
						}
					}

					// WireBuyer
					//TODONOW
					if ( humanFlag == 1 && wireBuyerFlag == 1 && wireBuyerStatus == 1 ) {
						if ( chkactive1 == 1  ) {
							if ( wireCost <= pricevalue1 && wire < amountvalue1 ) {
								buyWire();
								console.warn("1 bought");
							}
						}
						if ( chkactive2 == 1 ) {
							if ( wireCost <= pricevalue2 && wire < amountvalue2 ) {
								buyWire();
								console.warn("2 bought");
							}
						} 
						if ( wire <= 1 ) {
							buyWire();
						}
					}

					// First, Explore
					if (probeCount >= 1) {
						exploreUniverse();
					}

					// Then, Drones

					if (humanFlag == 0 && spaceFlag == 0) {
						updateDroneButtons();
					}

					if (humanFlag == 0) {

						updatePower();
						updateSwarm();
						acquireMatter();
						processMatter();

					}

					// Then Factories

					var fbst = 1;

					if (factoryBoost > 1) {
						fbst = factoryBoost * factoryLevel;
					}

					if (dismantle < 4) {
						clipClick(powMod * fbst
								* (Math.floor(factoryLevel) * factoryRate));
					}
					// Then Other Probe Functions

					if (spaceFlag == 1) {

						if (probeCount < 0) {
							probeCount = 0;
						}

						encounterHazards();
						spawnFactories();
						spawnHarvesters();
						spawnWireDrones();
						spawnProbes();
						drift();
						war();

					}

					// Auto-Clipper

					if (dismantle < 4) {
						clipClick(clipperBoost * (clipmakerLevel / 100));
						clipClick(megaClipperBoost * (megaClipperLevel * 5));
					}

					// Demand Curve

					if (humanFlag == 1) {

						marketing = (Math.pow(1.1, (marketingLvl - 1)));
						demand = (((.8 / margin) * marketing * marketingEffectiveness) * demandBoost);
						demand = demand + ((demand / 10) * prestigeU);

					}

					// Creativity

					if (creativityOn && operations >= (memory * 1000)) {
						calculateCreativity();
					}

					// Ending

					if (dismantle >= 1) {

						probeDesignDivElement.style.display = "none";
						if (endTimer1 >= 50) {
							increaseProbeTrustDivElement.style.display = "none";
						}

						if (endTimer1 >= 100) {
							increaseMaxTrustDivElement.style.display = "none";
						}

						if (endTimer1 >= 150) {
							spaceDivElement.style.display = "none";
						}

						if (endTimer1 >= 175) {
							battleCanvasDivElement.style.display = "none";
						}

						if (endTimer1 >= 190) {
							honorDivElement.style.display = "none";
						}

					}

					if (dismantle >= 2) {

						wireProductionDivElement.style.display = "none";
						wireTransDivElement.style.display = "";

						if (endTimer2 >= 50) {
							swarmGiftDivElement.style.display = "none";
						}

						if (endTimer2 >= 100) {
							swarmEngineElement.style.display = "none";
						}

						if (endTimer2 >= 150) {
							swarmSliderDivElement.style.display = "none";
						}

					}

					if (dismantle >= 3) {
						factoryDivSpaceElement.style.display = "none";
						clipsPerSecDivElement.style.display = "none";
						tothDivElement.style.display = "none";

					}

					if (dismantle >= 4) {
						strategyEngineElement.style.display = "none";
						tournamentManagementElement.style.display = "none";
					}

					if (dismantle >= 5) {

						btnQcomputeElement.style.display = "none";

						for (var i = 0; i < qChips.length; i++) {
							qChips[i].value = .5;
							qChipsElements[i].style.opacity = qChips[i].value;
						}

						if (endTimer4 == 10) {
							wire = wire + 1;
							transWireElement.innerHTML = formatWithCommas(wire);
						}

						if (endTimer4 >= 10) {
							qChipsElements[9].style.display = "none";
						}

						if (endTimer4 == 60) {
							wire = wire + 1;
							transWireElement.innerHTML = formatWithCommas(wire);
						}

						if (endTimer4 >= 60) {
							qChipsElements[8].style.display = "none";
						}

						if (endTimer4 == 100) {
							wire = wire + 1;
							transWireElement.innerHTML = formatWithCommas(wire);
						}

						if (endTimer4 >= 100) {
							qChipsElements[7].style.display = "none";
						}

						if (endTimer4 == 130) {
							wire = wire + 1;
							transWireElement.innerHTML = formatWithCommas(wire);
						}

						if (endTimer4 >= 130) {
							qChipsElements[6].style.display = "none";
						}

						if (endTimer4 == 150) {
							wire = wire + 1;
							transWireElement.innerHTML = formatWithCommas(wire);
						}

						if (endTimer4 >= 150) {
							qChipsElements[5].style.display = "none";
						}

						if (endTimer4 == 160) {
							wire = wire + 1;
							transWireElement.innerHTML = formatWithCommas(wire);
						}

						if (endTimer4 >= 160) {
							qChipsElements[4].style.display = "none";
						}

						if (endTimer4 == 165) {
							wire = wire + 1;
						}

						if (endTimer4 >= 165) {
							qChipsElements[3].style.display = "none";
						}

						if (endTimer4 == 169) {
							wire = wire + 1;
							transWireElement.innerHTML = formatWithCommas(wire);
						}

						if (endTimer4 >= 169) {
							qChipsElements[2].style.display = "none";
						}

						if (endTimer4 == 172) {
							wire = wire + 1;
							transWireElement.innerHTML = formatWithCommas(wire);
						}

						if (endTimer4 >= 172) {
							qChipsElements[1].style.display = "none";
						}

						if (endTimer4 == 174) {
							wire = wire + 1;
							transWireElement.innerHTML = formatWithCommas(wire);
						}

						if (endTimer4 >= 174) {
							qChipsElements[0].style.display = "none";
						}

						if (endTimer4 >= 250) {
							qComputingElement.style.display = "none";
						}

					}

					if (dismantle >= 6) {
						processorDisplayElement.style.display = "none";
					}

					if (dismantle >= 7) {
						compDivElement.style.display = "none";
						projectsDivElement.style.display = "none";

					}

					if (project148.flag == 1) {
						endTimer1++;
					}

					if (project211.flag == 1) {
						endTimer2++;
					}

					if (project212.flag == 1) {
						endTimer3++;
					}

					if (project213.flag == 1) {
						endTimer4++;
					}

					if (project215.flag == 1) {
						endTimer5++;
					}

					if (project216.flag == 1 && wire == 0) {
						endTimer6++;
					}

					if (endTimer6 >= 250) {
						creationDivElement.style.display = "none";
					}

					if (endTimer6 >= 500 && milestoneFlag == 15) {
						playThrenody();
						displayMessage("Universal Paperclips");
						milestoneFlag++;
					}

					if (endTimer6 >= 600 && milestoneFlag == 16) {
						displayMessage("a game by Frank Lantz");
						milestoneFlag++;
					}

					if (endTimer6 >= 700 && milestoneFlag == 17) {
						displayMessage("combat programming by Bennett Foddy");
						milestoneFlag++;
					}

					if (endTimer6 >= 800 && milestoneFlag == 18) {
						displayMessage("'Riversong' by Tonto's Expanding Headband used by kind permission of Malcolm Cecil");
						milestoneFlag++;
					}

					if (endTimer6 >= 900 && milestoneFlag == 19) {
						displayMessage("&#169; 2017 Everybody House Games");
						milestoneFlag++;
					}

				}, 10); // Slow Loop

var saveTimer = 0;
var secTimer = 0;

window.setInterval(function() {

	// Wire Price Fluctuation

	adjustWirePrice();

	// Sales Calculator

	if (humanFlag == 1) {

		if (Math.random() < (demand / 100)) {
			sellClips(Math.floor(.7 * Math.pow(demand, 1.15)));
		}

		// Fire Once a Second

		secTimer++;
		if (secTimer >= 10) {
			calculateRev();
			secTimer = 0;
		}

	}

	// Auto-Save

	saveTimer++;
	if (saveTimer >= 250) {
		save();
		saveTimer = 0;
	}

}, 100);

function setPrestigeValues() {
	// prestigeX
	if (prestigeX > 0) {
		autoClipperFlag = 1;
		for (var i = 1; i <= prestigeX; i++) {
			clipmakerLevel = clipmakerLevel + 1;
			clipmakerLevel2Element.innerHTML = clipmakerLevel;
			clipperCost = (Math.pow(1.1, clipmakerLevel) + 5);
			clipperCost = (Math.pow(1.1, clipmakerLevel) + 5);
			clipperCostElement.innerHTML = formatWithCommas(clipperCost, 2);
		}
	}
}